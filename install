#/bin/bash

SUDO=`which gksudo` || `which kdesudo` || exit 316
var=`zenity --list --radiolist --width="400" --height="300" --title="Myanmar Keyboards" --text="Please select the option:" --column="Check:" --column="Options" TRUE "Install Unicode Keyboard" FALSE "Install Zawgyi Keyboard" FALSE "Install Both" FALSE "Uninstall"`
case $var in
	"Install Unicode Keyboard")
		"$SUDO" "ibus-table-createdb -n /usr/share/ibus-table/tables/mm-myanmar3.db -s ./src/tables/mm-myanmar3.txt"
		"$SUDO" "cp -fv ./src/icons/mm-myanmar3.svg /usr/share/ibus-table/icons"
		"$SUDO" "mkdir -p /usr/share/fonts/mm"
		"$SUDO" "cp -fv ./src/fonts/mm3.ttf /usr/share/fonts/mm"
		"$SUDO" "cp -fv ./src/fonts/tharlon.ttf /usr/share/fonts/mm"
		gconftool --type list --list-type String --set /desktop/ibus/general/preload_engines "[mm-myanmar3]"
		ibus-daemon -x &
		im-switch -s ibus
		;;
	"Install Zawgyi Keyboard")
		"$SUDO" "ibus-table-createdb -n /usr/share/ibus-table/tables/mm-zawgyi.db -s ./src/tables/mm-zawgyi.txt"
		"$SUDO" "cp -fv ./src/icons/mm-zawgyi.svg /usr/share/ibus-table/icons"
		"$SUDO" "mkdir -p /usr/share/fonts/mm"
		"$SUDO" "cp -fv ./src/fonts/ZawgyiOne2008.ttf /usr/share/fonts/mm"
		gconftool --type list --list-type String --set /desktop/ibus/general/preload_engines "[mm-zawgyi]"
		ibus-daemon -x &
		im-switch -s ibus
		;;
	"Install Both")
		"$SUDO" "ibus-table-createdb -n /usr/share/ibus-table/tables/mm-myanmar3.db -s ./src/tables/mm-myanmar3.txt"
		"$SUDO" "cp -fv ./src/icons/mm-myanmar3.svg /usr/share/ibus-table/icons"
		"$SUDO" "ibus-table-createdb -n /usr/share/ibus-table/tables/mm-zawgyi.db -s ./src/tables/mm-zawgyi.txt"
		"$SUDO" "cp -fv ./src/icons/mm-zawgyi.svg /usr/share/ibus-table/icons"
		"$SUDO" "mkdir -p /usr/share/fonts/mm"
		"$SUDO" "cp -fv ./src/fonts/mm3.ttf /usr/share/fonts/mm"
		"$SUDO" "cp -fv ./src/fonts/tharlon.ttf /usr/share/fonts/mm"
		"$SUDO" "cp -fv ./src/fonts/ZawgyiOne2008.ttf /usr/share/fonts/mm"
		gconftool --type list --list-type String --set /desktop/ibus/general/preload_engines "[mm-myanmar3,mm-zawgyi]"
		ibus-daemon -x &
		im-switch -s ibus
		;;
	"Uninstall")
		"$SUDO" "rm -fv /usr/share/ibus-table/tables/mm*"
		"$SUDO" "rm -fv /usr/share/ibus-table/icons/mm-myanmar3.svg"
		"$SUDO" "rm -fv /usr/share/ibus-table/icons/mm-zawgyi.svg"
		"$SUDO" "rm -rfv /usr/share/fonts/mm"
        gconftool --type list --list-type String --set /desktop/ibus/general/preload_engines "[]"
        "$SUDO" "killall ibus-daemon"
        im-switch -s default
        ;;
esac